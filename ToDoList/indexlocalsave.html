<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ToDoList</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script>
      function setArrayLocalStorage(key, value) {
          localStorage.setItem(key, JSON.stringify(value));
      }

      function getArrayFromLocalStorage(key) {
          const localdata = localStorage.getItem(key);
          return localdata ? JSON.parse(localdata) : [];
      }

      window.onload = function () {
          const todoList = document.getElementById('todoList');
          const inputToDo = document.getElementById('inputToDo');
          const btnAdd = document.getElementById('btnAdd');

          btnAdd.addEventListener('click', function (e) {
              let todoValue = inputToDo.value;
              if (todoValue === '') {
                  alert('할일을 입력하세요.');
                  return;
              }


              const todos = getArrayFromLocalStorage('todos');
              todos.push(todoValue);
              setArrayLocalStorage('todos', todos);


              displayTodoList();
              inputToDo.value = '';
          });

          function displayTodoList() {
              const todos = getArrayFromLocalStorage('todos');
              todoList.innerHTML = '';

              todos.forEach(function (todoValue) {
                  const listItem = document.createElement('li');
                  listItem.className = 'd-flex list-group-item';
                  listItem.innerText = todoValue;

                  const listItemBtn = document.createElement('button');
                  listItemBtn.className = 'btn-close ms-auto';
                  listItemBtn.onclick = function (e) {
                      let pNode = e.target.parentNode;
                      todoList.removeChild(pNode);

                      const todos = getArrayFromLocalStorage('todos');
                      const updatedTodos = todos.filter((item) => item !== todoValue);
                      setArrayLocalStorage('todos', updatedTodos);
                  };

                  listItem.appendChild(listItemBtn);
                  todoList.appendChild(listItem);
              });
          }

          displayTodoList();
      };
    </script>
  </head>
  <body>
    <div class="container">
        <h3 class="p-3 mt-5 bg-primary text-light">ToDoList</h3>
        <p class="p-3">
            오늘 할일을 작성해 보세요.
        </p>
        <div class="input-group mb-3">
            <input type="text" id ="inputToDo" class="form-control" placeholder="할일을 입력하세요.">
            <button class="btn bg-primary text-light" type="button" id="btnAdd">추가</button>
          </div>
          <ol id="todoList" class="list-group list-groupnumbered"></ol>
      </div>
  </body>
</html>